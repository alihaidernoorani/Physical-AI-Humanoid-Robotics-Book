"use strict";(globalThis.webpackChunktextbook_physical_ai=globalThis.webpackChunktextbook_physical_ai||[]).push([[109],{6212(e,i,n){n.d(i,{A:()=>t});var r=n(6540),o=n(4848);const t=({title:e,problem:i,solution:n,hints:t=[],initialCode:s="",className:a=""})=>{const[l,c]=(0,r.useState)(s),[d,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[g,b]=(0,r.useState)(null);return(0,o.jsxs)("div",{className:`exercise-component ${a}`,style:{border:"1px solid #ddd",borderRadius:"8px",padding:"1rem",margin:"1rem 0",backgroundColor:"#fff"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0"},children:e}),(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("h5",{style:{margin:"0.5rem 0",color:"#202124"},children:"Problem:"}),(0,o.jsx)("div",{style:{padding:"0.5rem",backgroundColor:"#f9f9f9",borderRadius:"4px"},children:i})]}),t.length>0&&(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("button",{onClick:()=>u(!p),style:{padding:"0.5rem 1rem",backgroundColor:"#fbbc04",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",marginBottom:"0.5rem"},children:p?"Hide Hint":"Show Hint"}),p&&(0,o.jsxs)("div",{style:{padding:"0.5rem",backgroundColor:"#fef7e0",borderRadius:"4px",border:"1px solid #fbbc04"},children:[(0,o.jsx)("strong",{children:"Hint:"})," ",t[0]]})]}),(0,o.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,o.jsx)("h5",{style:{margin:"0.5rem 0",color:"#202124"},children:"Your Solution:"}),(0,o.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),style:{width:"100%",minHeight:"150px",padding:"0.5rem",fontFamily:"monospace",border:"1px solid #ddd",borderRadius:"4px",fontSize:"0.9rem"},placeholder:"Write your solution here..."})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[(0,o.jsx)("button",{onClick:()=>{b({success:!0,message:"Code executed successfully! Check your logic against the solution."}),f(!0)},style:{padding:"0.5rem 1rem",backgroundColor:"#4caf50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Run Code"}),(0,o.jsx)("button",{onClick:()=>m(!d),style:{padding:"0.5rem 1rem",backgroundColor:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:d?"Hide Solution":"Show Solution"}),(0,o.jsx)("button",{onClick:()=>{c(s),m(!1),u(!1),f(!1),b(null)},style:{padding:"0.5rem 1rem",backgroundColor:"#9e9e9e",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Reset"})]}),h&&g&&(0,o.jsxs)("div",{style:{padding:"0.75rem",borderRadius:"4px",backgroundColor:g.success?"#e8f5e9":"#ffebee",border:"1px solid "+(g.success?"#4caf50":"#f44336"),marginBottom:"1rem"},children:[(0,o.jsx)("strong",{children:"Status:"})," ",g.message]}),d&&(0,o.jsxs)("div",{style:{padding:"0.5rem",backgroundColor:"#e8f5e9",borderRadius:"4px",border:"1px solid #4caf50"},children:[(0,o.jsx)("h5",{style:{margin:"0.5rem 0",color:"#202124"},children:"Solution:"}),(0,o.jsx)("pre",{style:{padding:"0.5rem",backgroundColor:"#f1f8e9",borderRadius:"4px",overflowX:"auto",whiteSpace:"pre-wrap"},children:n})]})]})}},7589(e,i,n){n.d(i,{A:()=>t});var r=n(6540),o=n(4848);const t=({question:e,options:i,correctAnswer:n,explanation:t,className:s=""})=>{const a=Array.isArray(i)?i:i&&"string"==typeof i?i.split("||"):[],[l,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(!1),[p,u]=(0,r.useState)(!1),h=e=>{if(d)return;c(e);u(e===n),m(!0)},f=e=>d?e===n?{padding:"0.75rem",margin:"0.5rem 0",border:"1px solid #4caf50",borderRadius:"4px",backgroundColor:"#e8f5e9",fontWeight:"bold"}:e===l&&e!==n?{padding:"0.75rem",margin:"0.5rem 0",border:"1px solid #f44336",borderRadius:"4px",backgroundColor:"#ffebee"}:{padding:"0.75rem",margin:"0.5rem 0",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#f5f5f5"}:{padding:"0.75rem",margin:"0.5rem 0",cursor:"pointer",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:l===e?"#e3f2fd":"#fff"};return(0,o.jsxs)("div",{className:`quiz-component ${s}`,style:{border:"1px solid #ddd",borderRadius:"8px",padding:"1rem",margin:"1rem 0",backgroundColor:"#fff"},children:[(0,o.jsx)("h4",{style:{margin:"0 0 1rem 0"},children:e}),(0,o.jsx)("div",{children:a.map((i,n)=>(0,o.jsxs)("div",{style:f(i),onClick:()=>h(i),children:[(0,o.jsx)("input",{type:"radio",name:`quiz-${e}`,value:i,checked:l===i,onChange:()=>{},disabled:d,style:{marginRight:"0.5rem"}}),i]},n))}),d&&(0,o.jsxs)("div",{style:{marginTop:"1rem",padding:"0.75rem",borderRadius:"4px",backgroundColor:p?"#e8f5e9":"#ffebee",border:"1px solid "+(p?"#4caf50":"#f44336")},children:[(0,o.jsx)("p",{style:{margin:"0.5rem 0",fontWeight:"bold"},children:p?"\u2705 Correct!":"\u274c Incorrect"}),t&&(0,o.jsxs)("p",{style:{margin:"0.5rem 0"},children:[(0,o.jsx)("strong",{children:"Explanation:"})," ",t]})]}),d?(0,o.jsx)("button",{onClick:()=>{c(null),m(!1),u(!1)},style:{marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"#2196f3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Try Again"}):l&&(0,o.jsx)("button",{onClick:()=>h(l),style:{marginTop:"1rem",padding:"0.5rem 1rem",backgroundColor:"#4caf50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Submit Answer"})]})}},7639(e,i,n){n.d(i,{A:()=>o});n(6540);var r=n(4848);const o=({title:e,description:i,src:n,alt:o,caption:t,className:s=""})=>(0,r.jsxs)("div",{className:`diagram-component ${s}`,style:{textAlign:"center",margin:"1.5rem 0",padding:"1rem",border:"1px solid #eee",borderRadius:"8px",backgroundColor:"#fafafa"},children:[e&&(0,r.jsx)("h5",{style:{margin:"0 0 1rem 0",color:"#202124",fontSize:"1rem",fontWeight:"bold"},children:e}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto",maxWidth:"100%"},children:n?(0,r.jsx)("img",{src:n,alt:o||e||"Diagram",style:{maxWidth:"100%",height:"auto",border:"1px solid #ddd",borderRadius:"4px"}}):(0,r.jsx)("div",{style:{width:"100%",height:"200px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5",border:"2px dashed #ccc",borderRadius:"4px",color:"#666"},children:"Diagram placeholder"})}),(i||t)&&(0,r.jsxs)("div",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#5f6368",textAlign:"left",padding:"0.5rem"},children:[i&&(0,r.jsx)("p",{style:{margin:"0.5rem 0"},children:i}),t&&(0,r.jsxs)("p",{style:{margin:"0.5rem 0",fontStyle:"italic"},children:[(0,r.jsx)("strong",{children:"Figure:"})," ",t]})]})]})},8453(e,i,n){n.d(i,{R:()=>s,x:()=>a});var r=n(6540);const o={},t=r.createContext(o);function s(e){const i=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(t.Provider,{value:i},e.children)}},8573(e,i,n){n.r(i),n.d(i,{assets:()=>p,contentTitle:()=>m,default:()=>f,frontMatter:()=>d,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"ros2-nervous-system/ros2-topics-services-actions","title":"Advanced ROS 2 Communication Patterns","description":"Learning Objectives","source":"@site/docs/ros2-nervous-system/02-ros2-topics-services-actions.mdx","sourceDirName":"ros2-nervous-system","slug":"/ros2-nervous-system/ros2-topics-services-actions","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/ros2-nervous-system/ros2-topics-services-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ros2-nervous-system/02-ros2-topics-services-actions.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Advanced ROS 2 Communication Patterns","sidebar_label":"Advanced Communication"},"sidebar":"tutorialSidebar","previous":{"title":"ROS2 Nodes","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/ros2-nervous-system/ros2-nodes"},"next":{"title":"Python ROS Agents","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/ros2-nervous-system/writing-ros2-agents-python"}}');var o=n(4848),t=n(8453),s=n(8844),a=n(7589),l=n(6212),c=n(7639);const d={title:"Advanced ROS 2 Communication Patterns",sidebar_label:"Advanced Communication"},m=void 0,p={},u=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Quality of Service (QoS) in Depth",id:"quality-of-service-qos-in-depth",level:2},{value:"Primary QoS Policies",id:"primary-qos-policies",level:3},{value:"Reliability Policies",id:"reliability-policies",level:3},{value:"Durability Policies",id:"durability-policies",level:3},{value:"History Policies",id:"history-policies",level:3},{value:"Advanced Service Implementations",id:"advanced-service-implementations",level:2},{value:"Service Architecture",id:"service-architecture",level:3},{value:"Service Implementation Example",id:"service-implementation-example",level:3},{value:"Service Client Implementation",id:"service-client-implementation",level:3},{value:"Action Server and Client Patterns",id:"action-server-and-client-patterns",level:2},{value:"Action Architecture",id:"action-architecture",level:3},{value:"Action Server Implementation",id:"action-server-implementation",level:3},{value:"Action Client Implementation",id:"action-client-implementation",level:3},{value:"Communication Performance Optimization",id:"communication-performance-optimization",level:2},{value:"Message Size Optimization",id:"message-size-optimization",level:3},{value:"Network Partitioning Strategies",id:"network-partitioning-strategies",level:3},{value:"Monitoring and Profiling",id:"monitoring-and-profiling",level:3},{value:"Ethical &amp; Safety Considerations",id:"ethical--safety-considerations",level:2},{value:"Summary",id:"summary",level:2}];function h(e){const i={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,o.jsx)(i.p,{children:"By the end of this chapter, you will:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Configure and optimize Quality of Service (QoS) policies for different robot communication needs"}),"\n",(0,o.jsx)(i.li,{children:"Implement complex service interfaces for synchronous robot operations with error handling"}),"\n",(0,o.jsx)(i.li,{children:"Design and implement action-based interfaces for long-running robot behaviors with feedback"}),"\n",(0,o.jsx)(i.li,{children:"Analyze and optimize communication performance for real-time humanoid robot systems"}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"quality-of-service-qos-in-depth",children:"Quality of Service (QoS) in Depth"}),"\n",(0,o.jsx)(i.p,{children:"Quality of Service (QoS) policies in ROS 2 provide fine-grained control over communication characteristics. They enable precise tuning for different robot applications, which is crucial for humanoid robots with varying requirements for reliability, latency, and data delivery."}),"\n",(0,o.jsx)(s.A,{type:"tip",title:"QoS Best Practice",children:(0,o.jsx)(i.p,{children:"Always match your QoS settings to the criticality and performance requirements of your specific robot application. Safety-critical data like IMU readings for balance control should use reliable delivery, while perception data might use best-effort for better performance."})}),"\n",(0,o.jsx)(i.h3,{id:"primary-qos-policies",children:"Primary QoS Policies"}),"\n",(0,o.jsx)(i.p,{children:"The main QoS policies you'll work with include:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Reliability"}),": Choose between best-effort (faster, may lose messages) or reliable (slower, ensures delivery)"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Durability"}),": Volatile (new subscribers don't get old messages) vs. transient-local (new subscribers get latest message)"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"History"}),": Keep-all (store all messages) vs. keep-last (store only recent messages)"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Deadline"}),": Maximum time between consecutive messages"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Lifespan"}),": How long messages are kept before being dropped"]}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"For humanoid robots, IMU data critical for balance control requires reliable delivery and low latency. In contrast, camera feeds for perception might tolerate best-effort delivery with higher latency."}),"\n",(0,o.jsx)(a.A,{question:"Which QoS policy would be most appropriate for IMU data used in humanoid robot balance control?",options:["Best-effort reliability with keep-last history","Reliable reliability with keep-all history","Reliable reliability with keep-last history","Best-effort reliability with keep-all history"],correctAnswer:2,explanation:"For safety-critical IMU data in balance control, reliable delivery is essential to ensure no data is lost. Keep-last history is typically sufficient since only the most recent IMU readings are relevant for control."}),"\n",(0,o.jsx)(i.h3,{id:"reliability-policies",children:"Reliability Policies"}),"\n",(0,o.jsx)(i.p,{children:"Reliability policies determine how messages are delivered between nodes:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Reliable"}),": Guarantees message delivery but may result in higher latency - ideal for safety-critical applications like humanoid balance control"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Best-effort"}),": Provides lower latency but doesn't guarantee delivery - suitable for sensor data where occasional message loss is acceptable"]}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"The choice between these policies directly impacts the robot's ability to maintain stable operation, especially under varying network conditions."}),"\n",(0,o.jsx)(i.h3,{id:"durability-policies",children:"Durability Policies"}),"\n",(0,o.jsx)(i.p,{children:"Durability policies control how messages are retained for late-joining subscribers:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Volatile"}),": Provides the highest performance by not retaining messages for late subscribers - appropriate for high-frequency sensor data"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Transient-local"}),": Ensures newly connected subscribers receive the most recent messages - valuable for visualization tools or logging nodes"]}),"\n"]}),"\n",(0,o.jsx)(i.h3,{id:"history-policies",children:"History Policies"}),"\n",(0,o.jsx)(i.p,{children:"History policies determine how many messages are stored for delivery:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Keep-all"}),": Stores all messages until delivered (memory intensive but ensures no data loss)"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Keep-last"}),": Stores only the most recent messages (balances memory usage with data availability)"]}),"\n"]}),"\n",(0,o.jsx)(c.A,{title:"QoS Policy Effects",description:"How different QoS policies affect message delivery characteristics",width:"700",height:"400"}),"\n",(0,o.jsx)(l.A,{title:"QoS Configuration Exercise",problem:"Configure a ROS 2 publisher for a humanoid robot's camera feed that should prioritize performance over reliability, but still retain the last 5 frames for late-joining subscribers.",hints:["Use the rclpy.qos module","Set reliability to BEST_EFFORT","Set durability to VOLATILE","Set history to KEEP_LAST with depth of 5"],solution:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy, HistoryPolicy\n\n# Create a QoS profile for camera feed prioritizing performance\ncamera_qos_profile = QoSProfile(\n  depth=5,  # Keep last 5 messages\n  reliability=ReliabilityPolicy.BEST_EFFORT,  # Prioritize performance over delivery guarantee\n  durability=DurabilityPolicy.VOLATILE,  # Don't keep messages for late-joining subscribers\n  history=HistoryPolicy.KEEP_LAST  # Keep only the most recent samples\n)"}),"\n",(0,o.jsx)(i.h2,{id:"advanced-service-implementations",children:"Advanced Service Implementations"}),"\n",(0,o.jsx)(i.p,{children:"Complex service interfaces in ROS 2 extend basic request-response patterns to handle sophisticated robot operations with comprehensive error handling and state management. In humanoid robotics, services often manage operations that require guaranteed delivery and specific responses like calibration routines, configuration changes, or state queries with complex return values."}),"\n",(0,o.jsx)(i.h3,{id:"service-architecture",children:"Service Architecture"}),"\n",(0,o.jsx)(i.p,{children:"Services provide synchronous request-response communication patterns suitable for operations that require acknowledgment and result delivery. The synchronous nature ensures that clients receive definitive responses, which is critical for safety-related operations where the outcome must be known before proceeding."}),"\n",(0,o.jsx)(s.A,{type:"warning",title:"Error Handling",children:(0,o.jsx)(i.p,{children:"Service servers in safety-critical humanoid robots should implement comprehensive error checking and provide meaningful error messages that enable clients to take appropriate recovery actions."})}),"\n",(0,o.jsx)(i.h3,{id:"service-implementation-example",children:"Service Implementation Example"}),"\n",(0,o.jsx)(i.p,{children:"Here's how to implement a complex service with error handling:"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import Trigger  # Using a simple service for example\r\n\r\nclass CalibrationService(Node):\r\n    def __init__(self):\r\n        super().__init__('calibration_service')\r\n        self.srv = self.create_service(\r\n            Trigger,\r\n            'calibrate_joint',\r\n            self.calibrate_joint_callback\r\n        )\r\n\r\n    def calibrate_joint_callback(self, request, response):\r\n        try:\r\n            # Perform calibration logic\r\n            success = self.perform_calibration()\r\n\r\n            if success:\r\n                response.success = True\r\n                response.message = \"Calibration completed successfully\"\r\n            else:\r\n                response.success = False\r\n                response.message = \"Calibration failed\"\r\n\r\n        except Exception as e:\r\n            response.success = False\r\n            response.message = f\"Calibration error: {str(e)}\"\r\n\r\n        return response\r\n\r\n    def perform_calibration(self):\r\n        # Complex calibration logic here\r\n        # This is a simplified example\r\n        return True  # Simulate successful calibration\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    calibration_service = CalibrationService()\r\n\r\n    try:\r\n        rclpy.spin(calibration_service)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        calibration_service.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,o.jsx)(i.h3,{id:"service-client-implementation",children:"Service Client Implementation"}),"\n",(0,o.jsx)(i.p,{children:"Service clients should implement appropriate timeout values based on expected service execution time and include retry logic for non-critical operations that might fail due to temporary system conditions."}),"\n",(0,o.jsx)(a.A,{question:"Which of the following is the most important consideration for service timeout values in humanoid robots?",options:["Always use the shortest possible timeout to improve performance","Balance responsiveness with the time required for complex operations","Use fixed timeout values for all services to maintain consistency","Set timeout values to the maximum possible to ensure completion"],correctAnswer:1,explanation:"For humanoid robots, timeout values must balance responsiveness with the time required for complex operations, particularly for operations involving physical movement or sensor data processing."}),"\n",(0,o.jsx)(i.h2,{id:"action-server-and-client-patterns",children:"Action Server and Client Patterns"}),"\n",(0,o.jsx)(i.p,{children:"Action-based communication in ROS 2 provides sophisticated interfaces for long-running operations with feedback, goal preemption, and result delivery. For humanoid robots, actions are essential for complex behaviors like navigation, manipulation, and coordinated motion sequences that require continuous monitoring and potential interruption."}),"\n",(0,o.jsx)(i.h3,{id:"action-architecture",children:"Action Architecture"}),"\n",(0,o.jsx)(i.p,{children:"The action architecture includes three distinct communication channels:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Goal"}),": The desired action to be performed, including parameters and constraints"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Feedback"}),": Continuous updates on the progress of the operation, enabling other systems to coordinate appropriately"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Result"}),": The final outcome of the operation, including any relevant data or status information"]}),"\n"]}),"\n",(0,o.jsx)(c.A,{title:"Action Communication Pattern",description:"Three-channel communication for long-running operations",width:"700",height:"400"}),"\n",(0,o.jsx)(s.A,{type:"tip",title:"When to Use Actions",children:(0,o.jsx)(i.p,{children:'Use actions for long-running operations that need to provide feedback and allow for interruption, such as navigation, manipulation, or complex motion sequences."'})}),"\n",(0,o.jsx)(i.h3,{id:"action-server-implementation",children:"Action Server Implementation"}),"\n",(0,o.jsx)(i.p,{children:"Action servers implement state machines that manage the lifecycle of long-running operations. The typical action server state flow includes:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Idle"}),": Server is waiting for a new goal"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Active"}),": Goal is being executed"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Succeeded"}),": Goal completed successfully"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Aborted"}),": Goal execution failed"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Preempted"}),": Goal was cancelled in favor of a new goal"]}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"For humanoid robots, this state management is critical to maintain system stability and enable safe operation. The server must handle goal acceptance, execution monitoring, feedback generation, and proper cleanup upon completion or cancellation."}),"\n",(0,o.jsx)(i.h3,{id:"action-client-implementation",children:"Action Client Implementation"}),"\n",(0,o.jsx)(i.p,{children:"Action clients provide interfaces for monitoring and controlling long-running operations. They can send goals to action servers, monitor progress through feedback, and send cancel requests when necessary."}),"\n",(0,o.jsx)(i.p,{children:"The ability to preempt actions is particularly important for safety-critical robots that may need to interrupt ongoing behaviors in response to emergency situations."}),"\n",(0,o.jsx)(l.A,{title:"Action Client Implementation",problem:"Implement a ROS 2 action client that sends a navigation goal to a humanoid robot and monitors progress with appropriate timeout handling.",hints:["Use the rclpy.action module","Set appropriate timeout values","Handle preemption and cancellation","Monitor feedback for progress updates"],solution:"import rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom nav2_msgs.action import NavigateToPose\nimport time\n\nclass NavigationClient(Node):\n  def __init__(self):\n      super().__init__('navigation_client')\n      self._action_client = ActionClient(self, NavigateToPose, 'navigate_to_pose')\n\n  def send_goal(self, pose):\n      goal_msg = NavigateToPose.Goal()\n      goal_msg.pose = pose\n\n      self._action_client.wait_for_server()\n      future = self._action_client.send_goal_async(goal_msg)\n\n      # Wait for result with timeout\n      rclpy.spin_until_future_complete(self, future, timeout_sec=30.0)\n\n      if future.result() is not None:\n          goal_handle = future.result()\n          if goal_handle.accepted:\n              self.get_logger().info('Goal accepted')\n              result_future = goal_handle.get_result_async()\n              rclpy.spin_until_future_complete(self, result_future, timeout_sec=60.0)\n              return result_future.result()\n      else:\n          self.get_logger().error('Goal rejected')\n          return None"}),"\n",(0,o.jsx)(a.A,{question:"Which of the following is NOT a communication channel in ROS 2 actions?",options:["Goal","Feedback","Result","Status"],correctAnswer:3,explanation:"ROS 2 actions have three communication channels: Goal, Feedback, and Result. Status is not a separate channel but is part of the feedback."}),"\n",(0,o.jsx)(i.h2,{id:"communication-performance-optimization",children:"Communication Performance Optimization"}),"\n",(0,o.jsx)(i.p,{children:"Optimizing communication performance in ROS 2 systems requires careful consideration of QoS policies, message sizes, and network topology. For humanoid robots, real-time performance is critical as communication optimization directly impacts the robot's ability to respond to environmental changes and execute complex behaviors reliably."}),"\n",(0,o.jsx)(i.h3,{id:"message-size-optimization",children:"Message Size Optimization"}),"\n",(0,o.jsx)(i.p,{children:"Message size optimization involves balancing the amount of information transmitted with the frequency of communication:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Large messages provide comprehensive information but consume bandwidth and increase latency"}),"\n",(0,o.jsx)(i.li,{children:"Small messages reduce overhead but may require multiple transmissions to convey complete information"}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"For humanoid robots, this balance is particularly important for sensor data, as the trade-off between data completeness and update frequency affects the robot's situational awareness."}),"\n",(0,o.jsx)(s.A,{type:"danger",title:"Performance Impact",children:(0,o.jsx)(i.p,{children:"Poor communication performance can severely impact humanoid robot safety and responsiveness. Always optimize communication patterns for your specific application requirements."})}),"\n",(0,o.jsx)(i.h3,{id:"network-partitioning-strategies",children:"Network Partitioning Strategies"}),"\n",(0,o.jsx)(i.p,{children:"Network partitioning strategies can improve communication performance by organizing nodes into logical groups with optimized QoS settings. For humanoid robots, this might involve separating safety-critical communication paths from less critical data streams to ensure critical information receives priority and reliable delivery."}),"\n",(0,o.jsx)(i.p,{children:"The use of multiple DDS domains or partitions can further isolate communication paths, preventing interference between different subsystems."}),"\n",(0,o.jsx)(i.h3,{id:"monitoring-and-profiling",children:"Monitoring and Profiling"}),"\n",(0,o.jsx)(i.p,{children:"Monitoring and profiling tools are essential for identifying communication bottlenecks and optimizing performance. ROS 2 provides tools for analyzing message rates, latency, and resource usage, which can be used to identify areas for improvement."}),"\n",(0,o.jsx)(i.p,{children:"For humanoid robots, continuous monitoring of communication performance is important to maintain system stability and identify potential issues before they affect robot operation."}),"\n",(0,o.jsx)(i.h2,{id:"ethical--safety-considerations",children:"Ethical & Safety Considerations"}),"\n",(0,o.jsx)(i.p,{children:"The design of advanced communication patterns in humanoid robots has important ethical and safety implications:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"The reliability of QoS configurations affects the consistency of robot behavior, directly impacting safety in human environments"}),"\n",(0,o.jsx)(i.li,{children:"Service calls for critical operations must be designed with appropriate timeouts and error handling to prevent system hangs that could lead to unsafe robot behavior"}),"\n",(0,o.jsx)(i.li,{children:"Actions for robot behaviors must include proper preemption capabilities to allow for emergency stops or safety interventions, which is particularly important as humanoid robots operate in close proximity to humans"}),"\n"]}),"\n",(0,o.jsx)(s.A,{type:"danger",title:"Safety Critical",children:(0,o.jsx)(i.p,{children:'For safety-critical operations in humanoid robots, always implement proper error handling, timeouts, and preemption capabilities to ensure safe robot operation."'})}),"\n",(0,o.jsx)(i.h2,{id:"summary",children:"Summary"}),"\n",(0,o.jsx)(i.p,{children:"In this chapter, we've covered advanced ROS 2 communication patterns:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Quality of Service (QoS) policies"})," provide fine-grained control over communication characteristics for different robot applications"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Complex service interfaces"})," enable sophisticated robot operations with comprehensive error handling and state management"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Action-based communication"})," supports long-running operations with feedback, goal preemption, and result delivery"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Proper QoS configuration"})," is critical for achieving real-time performance in humanoid robot systems"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Communication performance optimization"})," requires balancing message size, frequency, and reliability requirements"]}),"\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.strong,{children:"Safety-critical communication paths"})," should be isolated and prioritized in humanoid robot systems"]}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"These advanced communication patterns are essential for implementing the complete humanoid robot system in your projects. The QoS configuration skills you've learned will be crucial for achieving real-time performance, particularly for safety-critical communication paths. The service and action patterns will be essential for implementing complex humanoid behaviors like navigation, manipulation, and coordinated motion control."})]})}function f(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},8844(e,i,n){n.d(i,{A:()=>o});n(6540);var r=n(4848);const o=({type:e="note",title:i,children:n,className:o=""})=>{const t={note:{borderLeft:"4px solid #4285f4",backgroundColor:"#f0f4ff",color:"#202124"},tip:{borderLeft:"4px solid #34a853",backgroundColor:"#f0f9ff",color:"#202124"},warning:{borderLeft:"4px solid #fbbc04",backgroundColor:"#fef7e0",color:"#202124"},danger:{borderLeft:"4px solid #ea4335",backgroundColor:"#fce8e6",color:"#202124"}},s={note:"\u2139\ufe0f",tip:"\ud83d\udca1",warning:"\u26a0\ufe0f",danger:"\u274c"},a=t[e]||t.note,l=s[e]||s.note;return(0,r.jsx)("div",{className:`callout callout-${e} ${o}`,style:{border:"1px solid",borderRadius:"4px",padding:"1rem",margin:"1rem 0",...a},children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start"},children:[(0,r.jsx)("span",{style:{fontSize:"1.2rem",marginRight:"0.5rem"},children:l}),(0,r.jsxs)("div",{children:[i&&(0,r.jsx)("h5",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"0.5px"},children:i}),(0,r.jsx)("div",{children:n})]})]})})}}}]);